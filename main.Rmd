---
title: "main"
author: "Davide Capone"
date: "22/9/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library("dplyr")
library("ggplot2")
library("tidyverse")
library("tidytext")

```

```{r}
# Import original dataset
dataset <- read.csv("./datasets/tcc_ceds_music.csv")

# Tidying
tidy_dataset <- dataset %>% 
  select(artist_name, 
         track_name, 
         release_date, 
         genre, 
         lyrics, 
         len)

# add coloumn 'decade' to perform analysis
tidy_dataset <- tidy_dataset %>% 
  mutate(decade =
    case_when(
      2010 <= release_date ~ "10-20",
      2000 <= release_date ~ "00-10",
      1990 <= release_date ~ "90-00",
      1980 <= release_date ~ "80-90",
      1970 <= release_date ~ "70-80",
      1960 <= release_date ~ "60-70",
      release_date < 1960 ~ "50-60"
    )
  )

# ... save
write.csv(tidy_dataset, "./datasets/tcc_ceds_music_tidy.csv", row.names = TRUE)

```

```{r}
# Import tidy dataset
tidy_dataset <- data.frame(read.csv("./datasets/tcc_ceds_music_tidy.csv"))
  
```

```{r}
# - 
decades <- c("10-20", "00-10", "90-00", "80-90", "70-80", "60-70", "50-60")

# foreach decade i save their correspondents unigrams, bigrams, trigrams

unigrams_per_decade <- tidy_dataset %>%
  select(lyrics, decade) %>%
  group_by(decade) %>% 
  unnest_tokens(word, lyrics) %>% 
  count(word, sort = TRUE)


nrc_joy <- get_sentiments("nrc") %>% 
  filter(sentiment == "negative")

unigrams_per_decade %>%
  inner_join(nrc_joy) %>%
  count(word)




```


